"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var generatePage_1 = require("../shared/generatePage");
var fs_1 = __importDefault(require("fs"));
var path_1 = __importDefault(require("path"));
var utils_1 = require("../shared/utils");
// @ts-ignore
global.window = undefined;
var appServerInfo = JSON.parse(fs_1.default.readFileSync("atri-server-info.json").toString());
var promises = Promise.all([
    (0, utils_1.buildAppWithDefaults)(),
    (0, utils_1.buildServerWithDefaults)(),
]);
promises
    .then(function () {
    var outputDir = utils_1.ssgOutputPath;
    // copy app/static directory
    (0, generatePage_1.copyPublicDirectory)(appServerInfo, outputDir);
    (0, generatePage_1.buildPages)(appServerInfo, {
        paths: {
            appDistHtml: path_1.default.join(appServerInfo.publicDir, "index.html"),
            getAppText: path_1.default.join("dist", "app-node", "static", "js", "app.bundle.js"),
        },
        outputDir: outputDir,
    });
    (0, generatePage_1.copyAssets)(appServerInfo, outputDir);
})
    .catch(function (err) {
    console.log("Error\n", err);
});
//# sourceMappingURL=build-ssg.js.map